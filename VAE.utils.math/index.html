
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../VAE.utils.fileio/">
      
      
        <link rel="next" href="../VAE.utils.collection/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.21">
    
    
      
        <title>Mathematical functions - VAE project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#VAE.utils.math" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="VAE project" class="md-header__button md-logo" aria-label="VAE project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VAE project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mathematical functions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/andr-groth/VAE-project" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="VAE project" class="md-nav__button md-logo" aria-label="VAE project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    VAE project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/andr-groth/VAE-project" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Build model
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Build model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Train model
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Train model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.losses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Losses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.callbacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Callbacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.generators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.beta_schedulers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beta Scheduler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.fileio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileIO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Mathematical functions
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Mathematical functions
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#VAE.utils.math" class="md-nav__link">
    <span class="md-ellipsis">
      math
    </span>
  </a>
  
    <nav class="md-nav" aria-label="math">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.log_density_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      log_density_gaussian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.reduce_logmeanexp" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_logmeanexp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.similarity" class="md-nav__link">
    <span class="md-ellipsis">
      similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.log_density_gaussian_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      log_density_gaussian_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.logmeanexp_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      logmeanexp_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.kl_divergence_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      kl_divergence_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.wasserstein_distance_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      wasserstein_distance_numpy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Helper functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../example_VAE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VAE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../example_VAEp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VAEp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ... more
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#VAE.utils.math" class="md-nav__link">
    <span class="md-ellipsis">
      math
    </span>
  </a>
  
    <nav class="md-nav" aria-label="math">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.log_density_gaussian" class="md-nav__link">
    <span class="md-ellipsis">
      log_density_gaussian
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.reduce_logmeanexp" class="md-nav__link">
    <span class="md-ellipsis">
      reduce_logmeanexp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.similarity" class="md-nav__link">
    <span class="md-ellipsis">
      similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.log_density_gaussian_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      log_density_gaussian_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.logmeanexp_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      logmeanexp_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.kl_divergence_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      kl_divergence_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.utils.math.wasserstein_distance_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      wasserstein_distance_numpy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Mathematical functions</h1>

<div class="doc doc-object doc-module">



<h2 id="VAE.utils.math" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">VAE.utils.math</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>Collection of mathematical functions used in the VAE.</p>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="VAE.utils.math.log_density_gaussian" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.utils.math.log_density_gaussian</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">log_density_gaussian</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">all_combinations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculates the sampled log density of a Gaussian.</p>
<p>Version for Tensor arrays as inputs.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>sample</code></b>
            (<code><span title="tensorflow.Tensor">Tensor</span></code>)
        –
        <div class="doc-md-description">
          <p>Sample at which to compute the density.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>mean</code></b>
            (<code><span title="tensorflow.Tensor">Tensor</span></code>)
        –
        <div class="doc-md-description">
          <p>Mean of Gaussian distribution.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>logvar</code></b>
            (<code><span title="tensorflow.Tensor">Tensor</span></code>)
        –
        <div class="doc-md-description">
          <p>Log variance of Gaussian distribution.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>all_combinations</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>Whether to return values for all combinations of batch pairs of <code>sample</code> and <code>mean</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>axis</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        –
        <div class="doc-md-description">
          <p>The dimension over which all combinations are computed. Default is 0 meaning the batch dimension.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="tensorflow.Tensor">Tensor</span></code>
        –
        <div class="doc-md-description">
          <p>Tensor</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/utils/math.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_density_gaussian</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
                         <span class="n">mean</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
                         <span class="n">logvar</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
                         <span class="n">all_combinations</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                         <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the sampled log density of a Gaussian.</span>

<span class="sd">    Version for Tensor arrays as inputs.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        sample:</span>
<span class="sd">            Sample at which to compute the density.</span>
<span class="sd">        mean:</span>
<span class="sd">            Mean of Gaussian distribution.</span>
<span class="sd">        logvar:</span>
<span class="sd">            Log variance of Gaussian distribution.</span>
<span class="sd">        all_combinations:</span>
<span class="sd">            Whether to return values for all combinations of batch pairs of `sample` and `mean`.</span>
<span class="sd">        axis:</span>
<span class="sd">            The dimension over which all combinations are computed. Default is 0 meaning the batch dimension.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">all_combinations</span><span class="p">:</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">logvar</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">logvar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="n">log_density</span> <span class="o">=</span> <span class="n">LOG2PI</span> <span class="o">+</span> <span class="n">logvar</span> <span class="o">+</span> <span class="n">tf</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">logvar</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">log_density</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">log_density</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="VAE.utils.math.reduce_logmeanexp" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.utils.math.reduce_logmeanexp</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">reduce_logmeanexp</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculates Log(Mean(Exp(x))).</p>
<p>Version for Tensor arrays as inputs.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>input_tensor</code></b>
            (<code><span title="tensorflow.Tensor">Tensor</span></code>)
        –
        <div class="doc-md-description">
          <p>Input tensor.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>axis</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The dimensions to reduce.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>keepdims</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>Whether to keep the axis as singleton dimensions.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="tensorflow.Tensor">Tensor</span></code>
        –
        <div class="doc-md-description">
          <p>Tensor.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/utils/math.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reduce_logmeanexp</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates Log(Mean(Exp(x))).</span>

<span class="sd">    Version for Tensor arrays as inputs.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        input_tensor:</span>
<span class="sd">            Input tensor.</span>
<span class="sd">        axis:</span>
<span class="sd">            The dimensions to reduce.</span>
<span class="sd">        keepdims:</span>
<span class="sd">            Whether to keep the axis as singleton dimensions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lse</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_logsumexp</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span> <span class="o">//</span> <span class="n">tf</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lse</span><span class="p">)</span>
    <span class="n">log_n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">lse</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">lse</span> <span class="o">-</span> <span class="n">log_n</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="VAE.utils.math.similarity" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.utils.math.similarity</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">similarity</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the cosine similarity.</p>
<p>The function returns a similarity measure between all samples in a batch. First, a correlation matrix of the
normalized input is obtained (the cosine similarity matrix). Then, the similarity measure is defined as the
categorical cross entropy of the cosine similarity matrix of shape <code>(batch_size, batch_size)</code> with the identity
matrix as target. The correlation can be scaled by <code>temperature</code> prior to the calculation of the cross entropy.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>input_tensor</code></b>
            (<code><span title="tensorflow.Tensor">Tensor</span></code>)
        –
        <div class="doc-md-description">
          <p>Input tensor of shape <code>(batch_size, channels)</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>temperature</code></b>
            (<code>float</code>, default:
                <code>1.0</code>
)
        –
        <div class="doc-md-description">
          <p>Temperature for the softmax.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="tensorflow.Tensor">Tensor</span></code>
        –
        <div class="doc-md-description">
          <p>Tensor of shape <code>(batch_size,)</code>.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/utils/math.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">similarity</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the cosine similarity.</span>

<span class="sd">    The function returns a similarity measure between all samples in a batch. First, a correlation matrix of the</span>
<span class="sd">    normalized input is obtained (the cosine similarity matrix). Then, the similarity measure is defined as the</span>
<span class="sd">    categorical cross entropy of the cosine similarity matrix of shape `(batch_size, batch_size)` with the identity</span>
<span class="sd">    matrix as target. The correlation can be scaled by `temperature` prior to the calculation of the cross entropy.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        input_tensor:</span>
<span class="sd">            Input tensor of shape `(batch_size, channels)`.</span>
<span class="sd">        temperature:</span>
<span class="sd">            Temperature for the softmax.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tensor of shape `(batch_size,)`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># normalize input</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">l2_normalize</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># correlation matrix</span>
    <span class="n">similarity</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">l2</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">transpose_b</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># apply temperature</span>
    <span class="n">similarity</span> <span class="o">/=</span> <span class="n">temperature</span>
    <span class="c1"># target labels = diagonal elements</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">similarity</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># cross entropy loss</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">ks</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">sparse_categorical_crossentropy</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">similarity</span><span class="p">,</span> <span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loss</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="VAE.utils.math.log_density_gaussian_numpy" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.utils.math.log_density_gaussian_numpy</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">log_density_gaussian_numpy</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">all_combinations</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculates the sampled log density of a Gaussian.</p>
<p>Numpy version of :func:<code>log_density_gaussian</code>.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>sample</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> at which to compute the density.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>mean</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> represnting the mean of Gaussian distribution.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>logvar</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> represnting the log variance of Gaussian distribution.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>all_combinations</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>Whether to return values for all combinations of batch pairs of <code>sample</code> and <code>mean</code>.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>If <code>all_combinations=True</code> returns an array of shape <code>(batch_size, batch_size, latent_dim)</code>.</p>
      </div>
      </li>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>If <code>all_combinations=False</code> returns an array of shape <code>(batch_size, latent_dim)</code>.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/utils/math.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_density_gaussian_numpy</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
                               <span class="n">mean</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
                               <span class="n">logvar</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
                               <span class="n">all_combinations</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the sampled log density of a Gaussian.</span>

<span class="sd">    Numpy version of :func:`log_density_gaussian`.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        sample:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` at which to compute the density.</span>
<span class="sd">        mean:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` represnting the mean of Gaussian distribution.</span>
<span class="sd">        logvar:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` represnting the log variance of Gaussian distribution.</span>
<span class="sd">        all_combinations:</span>
<span class="sd">            Whether to return values for all combinations of batch pairs of `sample` and `mean`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If `all_combinations=True` returns an array of shape `(batch_size, batch_size, latent_dim)`.</span>
<span class="sd">        If `all_combinations=False` returns an array of shape `(batch_size, latent_dim)`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">all_combinations</span><span class="p">:</span>
        <span class="c1"># reshape to (batch_size, 1, latent_dim)</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># reshape to (1, batch_size, latent_dim)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">logvar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">logvar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">log_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="n">logvar</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">logvar</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">log_density</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">log_density</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="VAE.utils.math.logmeanexp_numpy" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.utils.math.logmeanexp_numpy</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">logmeanexp_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculates Log(Mean(Exp(x))).</p>
<p>Numpy version of :func:<code>logmeanexp</code>.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>x</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Input array.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>axis</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>The dimensions to reduce.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>keepdims</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>Whether to keep the axis as singleton dimensions.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>Numpy array.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/utils/math.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">logmeanexp_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates Log(Mean(Exp(x))).</span>

<span class="sd">    Numpy version of :func:`logmeanexp`.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        x:</span>
<span class="sd">            Input array.</span>
<span class="sd">        axis:</span>
<span class="sd">            The dimensions to reduce.</span>
<span class="sd">        keepdims:</span>
<span class="sd">            Whether to keep the axis as singleton dimensions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Numpy array.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lse</span> <span class="o">=</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">//</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">lse</span><span class="p">)</span>
    <span class="n">log_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lse</span> <span class="o">-</span> <span class="n">log_n</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="VAE.utils.math.kl_divergence_numpy" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.utils.math.kl_divergence_numpy</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">kl_divergence_numpy</span><span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">logvar1</span><span class="p">,</span> <span class="n">mean2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">logvar2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">all_combinations</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculates the KL divergence between two multivariate Gaussian distributions with diagonal covariance matrices.</p>
<p>The KL divergence is returned for each latent dimensions separately. Since the KL divergence is additive in the case
of diagonal covariance matrices, the KL divergence can be obtained from the sum over the last dimensions of the
output.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>mean1</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> representing the mean of the first Gaussian distribution.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>logvar1</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> representing the log variance of the second Gaussian distribution.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>mean2</code></b>
            (<code>float</code>, default:
                <code>0</code>
)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> representing the mean of the second Gaussian distribution. Defaults
to 0.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>logvar2</code></b>
            (<code>float</code>, default:
                <code>0</code>
)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> representing the log variance of the second Gaussian distribution.
Defaults to 0.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>all_combinations</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>Whether to return values for all combinations of batch pairs of <code>sample</code> and <code>mean</code>.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>If <code>all_combinations=True</code> returns an array of shape <code>(batch_size, batch_size, latent_dim)</code>.</p>
      </div>
      </li>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>If <code>all_combinations=False</code> returns an array of shape <code>(batch_size, latent_dim)</code>.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/utils/math.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">kl_divergence_numpy</span><span class="p">(</span><span class="n">mean1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">logvar1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">mean2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="n">logvar2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="n">all_combinations</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the KL divergence between two multivariate Gaussian distributions with diagonal covariance matrices.</span>

<span class="sd">    The KL divergence is returned for each latent dimensions separately. Since the KL divergence is additive in the case</span>
<span class="sd">    of diagonal covariance matrices, the KL divergence can be obtained from the sum over the last dimensions of the</span>
<span class="sd">    output.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mean1:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` representing the mean of the first Gaussian distribution.</span>
<span class="sd">        logvar1:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` representing the log variance of the second Gaussian distribution.</span>
<span class="sd">        mean2:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` representing the mean of the second Gaussian distribution. Defaults</span>
<span class="sd">            to 0.</span>
<span class="sd">        logvar2:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` representing the log variance of the second Gaussian distribution.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        all_combinations:</span>
<span class="sd">            Whether to return values for all combinations of batch pairs of `sample` and `mean`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If `all_combinations=True` returns an array of shape `(batch_size, batch_size, latent_dim)`.</span>
<span class="sd">        If `all_combinations=False` returns an array of shape `(batch_size, latent_dim)`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">all_combinations</span><span class="p">:</span>
        <span class="c1"># reshape to (batch_size, 1, latent_dim)</span>
        <span class="n">mean1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">logvar1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">logvar1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># reshape to (1, batch_size, latent_dim)</span>
        <span class="n">mean2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mean2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">logvar2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">logvar2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">kl_div</span> <span class="o">=</span> <span class="n">logvar2</span> <span class="o">-</span> <span class="n">logvar1</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logvar1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">logvar2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">kl_div</span> <span class="o">*=</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">kl_div</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="VAE.utils.math.wasserstein_distance_numpy" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.utils.math.wasserstein_distance_numpy</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">wasserstein_distance_numpy</span><span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">logvar1</span><span class="p">,</span> <span class="n">mean2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">logvar2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">all_combinations</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculates the Wasserstein distance between two multivariate Gaussian distributions with diagonal covariance
matrices.</p>
<p>The Wasserstein distance is returned for each latent dimensions separately. Since the Wasserstein distance is
additive in the case of diagonal covariance matrices, the Wasserstein distance can be obtained from the sum over the
last dimensions of the output.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>mean1</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> representing the mean of the first Gaussian distribution.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>logvar1</code></b>
            (<code>float</code>)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> representing the log variance of the second Gaussian distribution.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>mean2</code></b>
            (<code>float</code>, default:
                <code>0</code>
)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> representing the mean of the second Gaussian distribution. Defaults
to 0.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>logvar2</code></b>
            (<code>float</code>, default:
                <code>0</code>
)
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size, laten_dim)</code> representing the log variance of the second Gaussian distribution.
Defaults to 0.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>all_combinations</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>Whether to return values for all combinations of batch pairs of <code>sample</code> and <code>mean</code>.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>If <code>all_combinations=True</code> returns an array of shape <code>(batch_size, batch_size, latent_dim)</code>.</p>
      </div>
      </li>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>If <code>all_combinations=False</code> returns an array of shape <code>(batch_size, latent_dim)</code>.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/utils/math.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">wasserstein_distance_numpy</span><span class="p">(</span><span class="n">mean1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                               <span class="n">logvar1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                               <span class="n">mean2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                               <span class="n">logvar2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                               <span class="n">all_combinations</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the Wasserstein distance between two multivariate Gaussian distributions with diagonal covariance</span>
<span class="sd">    matrices.</span>

<span class="sd">    The Wasserstein distance is returned for each latent dimensions separately. Since the Wasserstein distance is</span>
<span class="sd">    additive in the case of diagonal covariance matrices, the Wasserstein distance can be obtained from the sum over the</span>
<span class="sd">    last dimensions of the output.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        mean1:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` representing the mean of the first Gaussian distribution.</span>
<span class="sd">        logvar1:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` representing the log variance of the second Gaussian distribution.</span>
<span class="sd">        mean2:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` representing the mean of the second Gaussian distribution. Defaults</span>
<span class="sd">            to 0.</span>
<span class="sd">        logvar2:</span>
<span class="sd">            Array of shape `(batch_size, laten_dim)` representing the log variance of the second Gaussian distribution.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        all_combinations:</span>
<span class="sd">            Whether to return values for all combinations of batch pairs of `sample` and `mean`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        If `all_combinations=True` returns an array of shape `(batch_size, batch_size, latent_dim)`.</span>
<span class="sd">        If `all_combinations=False` returns an array of shape `(batch_size, latent_dim)`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">all_combinations</span><span class="p">:</span>
        <span class="c1"># reshape to (batch_size, 1, latent_dim)</span>
        <span class="n">mean1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mean1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">logvar1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">logvar1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># reshape to (1, batch_size, latent_dim)</span>
        <span class="n">mean2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">mean2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">logvar2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">logvar2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">wd</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean1</span> <span class="o">-</span> <span class="n">mean2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logvar1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logvar2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">logvar1</span> <span class="o">+</span> <span class="n">logvar2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">wd</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Andreas Groth
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/andr-groth" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.sections", "navigation.expand", "content.code.copy", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a7c05c9e.min.js"></script>
      
    
  </body>
</html>