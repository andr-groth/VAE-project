
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../VAE.logs/">
      
      
        <link rel="next" href="../VAE.utils.beta_schedulers/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.21">
    
    
      
        <title>Generators - VAE project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#VAE.generators" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="VAE project" class="md-header__button md-logo" aria-label="VAE project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VAE project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Generators
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/andr-groth/VAE-project" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="VAE project" class="md-nav__button md-logo" aria-label="VAE project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    VAE project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/andr-groth/VAE-project" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Build model
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Build model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Train model
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Train model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.losses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Losses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.callbacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Callbacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Generators
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Generators
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#VAE.generators" class="md-nav__link">
    <span class="md-ellipsis">
      generators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      FitGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FitGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.nr_samples" class="md-nav__link">
    <span class="md-ellipsis">
      nr_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.get_ensemble_condition" class="md-nav__link">
    <span class="md-ellipsis">
      get_ensemble_condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.get_index" class="md-nav__link">
    <span class="md-ellipsis">
      get_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.get_sph_harmonics" class="md-nav__link">
    <span class="md-ellipsis">
      get_sph_harmonics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.get_tp_harmonics" class="md-nav__link">
    <span class="md-ellipsis">
      get_tp_harmonics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.on_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.summary" class="md-nav__link">
    <span class="md-ellipsis">
      summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.PredictGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      PredictGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PredictGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#VAE.generators.PredictGenerator.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.example_FitGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      example_FitGenerator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.beta_schedulers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beta Scheduler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.fileio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileIO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mathematical functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Helper functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../VAE.utils.plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plot functions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../example_VAE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VAE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../example_VAEp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VAEp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ... more
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#VAE.generators" class="md-nav__link">
    <span class="md-ellipsis">
      generators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      FitGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FitGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.nr_samples" class="md-nav__link">
    <span class="md-ellipsis">
      nr_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.get_ensemble_condition" class="md-nav__link">
    <span class="md-ellipsis">
      get_ensemble_condition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.get_index" class="md-nav__link">
    <span class="md-ellipsis">
      get_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.get_sph_harmonics" class="md-nav__link">
    <span class="md-ellipsis">
      get_sph_harmonics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.get_tp_harmonics" class="md-nav__link">
    <span class="md-ellipsis">
      get_tp_harmonics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.on_epoch_end" class="md-nav__link">
    <span class="md-ellipsis">
      on_epoch_end
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.FitGenerator.summary" class="md-nav__link">
    <span class="md-ellipsis">
      summary
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.PredictGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      PredictGenerator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PredictGenerator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#VAE.generators.PredictGenerator.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#VAE.generators.example_FitGenerator" class="md-nav__link">
    <span class="md-ellipsis">
      example_FitGenerator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Generators</h1>

<div class="doc doc-object doc-module">



<h2 id="VAE.generators" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">VAE.generators</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>Collection of generators for VAE model training.</p>
<p>Generator class for data given as a Numpy array(s).</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="VAE.generators.FitGenerator" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">VAE.generators.FitGenerator</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">FitGenerator</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">input_length</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">beta_scheduler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensemble_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensemble_type</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">ensemble_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensemble_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensemble_replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ensemble_sync</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_epoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prediction_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prediction_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repeat_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sample_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sph_degree</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tp_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="tensorflow.keras.utils.Sequence">Sequence</span></code></p>

  
      <p>Generator class for model training.</p>
<p>Given an Numpy array of shape <code>(set_size, data_length, channels)</code>, the generator prepares the <code>inputs and</code>targets<code>for the model training in :func:</code>keras.Model.fit_generator()`.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>datasets</code></b>
            (<code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, list[<span title="numpy.ndarray">ndarray</span>]]</code>)
        –
        <div class="doc-md-description">
          <p>Dataset used for training. The dataset can be either a single numpy array of shape <code>(set_size, data_length,
channels)</code> or a list of Numpy arrays. In case of a list of Numpy arrays, <code>set_size</code> and <code>channels</code> must be
the same, while <code>data_length</code> can vary. Missing (non-finite) values will be excluded from the samples.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>input_length</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>Length of input to the encoder.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>batch_size</code></b>
            (<code>int</code>, default:
                <code>32</code>
)
        –
        <div class="doc-md-description">
          <p>Batch size. Note that the effective batch size is <code>batch_size * repeat_samples</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>beta_scheduler</code></b>
        –
        <div class="doc-md-description">
          <p>Instance of :class:<code>BetaScheduler</code> that returns the <code>beta</code> parameters for the KL loss in each epoch.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>condition</code></b>
            (<code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, list[<span title="numpy.ndarray">ndarray</span>], dict]</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Additional data used as condition. The Numpy arrays must be of length <code>data_length</code> matching the Numpy
array(s)  in <code>dataset</code>. If a list is provided, the length of the list must match the length of <code>datasets</code>.
If a dict is provided, the keys must match <code>encoder</code> and <code>decoder</code>. This allows to pass different conditions
to the encoder and decoder, provided as the corresponding dict values.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>ensemble_size</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Size for the one-hot encoded ensemble condition.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>ensemble_type</code></b>
            (<code>str</code>, default:
                <code>&#39;random&#39;</code>
)
        –
        <div class="doc-md-description">
          <p>Whether to use the dataset index (<code>index</code>) or random ensemble condition (<code>random</code>, 'random_full'). If
<code>index</code>, the ensemble condition corresponds to the dataset index. If 'random' or <code>random_full</code>, the ensemble
condition is sampled from a uniform distribution in the range <code>ensemble_range</code>. The samples are the same for
all samples in a batch ('random') or different for each sample in a batch ('random_full'). Defaults to
<code>random</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>ensemble_index</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Array of indices used as ensemble condition if <code>ensemble_type</code> is <code>index</code>. Must match the length of
<code>dataset</code> and must be in range <code>(0, ensemble_size)</code>. Defaults to <code>None</code> meaning the dataset index is used.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>ensemble_range</code></b>
            (<code>tuple[int, int]</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Range of the random ensemble condition. Must be a subrange of <code>(0, ensemble_size)</code>. Defaults to <code>None</code> and
is set to <code>(0, ensemble_size)</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>ensemble_replace</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>Whether to sample the random ensemble condition with replacement if <code>repeat_samples &gt; 1</code>. Defaults to
<code>False</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>ensemble_sync</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        –
        <div class="doc-md-description">
          <p>Synchronize random ensemble conditions between encoder and decoder. If <code>True</code> , the random ensemble
conditions of the encoder and decoder are the same. Defaults to <code>False</code>, i.e. the random ensemble conditions
of the encoder an decoder are different random samples. Note that the ensemble conditions of the decoder and
prediction are always the same.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>filter_length</code></b>
            (<code><span title="typing.Union">Union</span>[int, tuple[int, int]]</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Length of the temporal filter for the inputs and targets.  A centered moving average filter of length <code>2 *
filter_length + 1</code> is applied to the inputs and targets. If a tuple of two ints is given, the first int is
the length of the filter for the input to the encoder and the target to the decoder. The second int is the
length of the filter for the target to the prediction. Defaults to <code>None</code>, i.e. no filter.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>initial_epoch</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        –
        <div class="doc-md-description">
          <p>Initial epoch at which the generator will start. This will affect the <code>beta</code> parameter.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>input_channels</code></b>
            (<code>list[int]</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Range of channels used as input. The items in the tuple refer to start, stop and step in slice notation.
Defaults to <code>None</code> means all channels are used.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>latitude</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>, default:
                <code>0</code>
)
        –
        <div class="doc-md-description">
          <p>Latitude in degree if the spherical harmonics are used for spatial condition.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>longitude</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Longitude of the data in degree if the spherical harmonics are used for spatial condition. Length of
<code>longitude</code> must be equal to <code>set_size</code>. Defaults to <code>None</code> and is set to <code>np.arange(0, 360, 360/set_size)</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>prediction_channels</code></b>
            (<code>list[int]</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Range of channels used for prediction. The items in the tuple refer to start, stop and step in slice
notation. Defaults to <code>None</code> means all channels are used.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>prediction_length</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Length of prediction. Defaults to <code>None</code> means no prediction.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>repeat_samples</code></b>
            (<code>int</code>, default:
                <code>1</code>
)
        –
        <div class="doc-md-description">
          <p>Number of times the same sample is repeated in the batch. This will augment the batch size. This options is
useful in combination with the ensemble condition, in which the same samples is presented multiple times
with different random samples of the ensemble conditions. Defaults to 1.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>sample_weights</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Sample weights of shape <code>(nr_datasets, set_size)</code>. Defaults to <code>None</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>shuffle</code></b>
            (<code>bool</code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
          <p>Shuffle samples order.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>sph_degree</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Number of spherical degrees if the spherical harmonics are used for spatial condition.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>strides</code></b>
            (<code>int</code>, default:
                <code>1</code>
)
        –
        <div class="doc-md-description">
          <p>Sample strides along second dimension of <code>data</code> of size <code>data_length</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>time</code></b>
            (<code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, list[<span title="numpy.ndarray">ndarray</span>]]</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Time of the data if the time-periodic harmonics are used for temporal condition. Must be of length
<code>data_length</code>. If a list is provided, the length of the list must match the length of <code>datasets</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>tp_period</code></b>
            (<code>float</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Maximal period for the temporal harmonics. See :func:<code>get_tp_harmonics</code>.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>dtype</code></b>
            (<code>str</code>, default:
                <code>&#39;float32&#39;</code>
)
        –
        <div class="doc-md-description">
          <p>Dtype of the data that will be returned.</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>VAE/generators.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">datasets</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]],</span>
             <span class="n">input_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
             <span class="n">beta_scheduler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">condition</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">ensemble_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">ensemble_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;random&#39;</span><span class="p">,</span>
             <span class="n">ensemble_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">ensemble_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">ensemble_replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">ensemble_sync</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">filter_length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">initial_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">input_channels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">latitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">longitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">prediction_channels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">prediction_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">repeat_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">sample_weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">sph_degree</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">strides</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">tp_period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;float32&#39;</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate generator.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">datasets</span><span class="p">]</span>

    <span class="n">shapes</span> <span class="o">=</span> <span class="p">{</span><span class="n">dataset</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;all datasets must have the same set_size and number of channels&#39;</span><span class="p">)</span>

    <span class="n">set_size</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="n">channels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_size</span> <span class="o">=</span> <span class="n">set_size</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_scheduler</span> <span class="o">=</span> <span class="n">beta_scheduler</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span> <span class="o">=</span> <span class="n">datasets</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_replace</span> <span class="o">=</span> <span class="n">ensemble_replace</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_size</span> <span class="o">=</span> <span class="n">ensemble_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_sync</span> <span class="o">=</span> <span class="n">ensemble_sync</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span> <span class="o">=</span> <span class="n">initial_epoch</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filter_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">filter_length</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_length</span> <span class="o">=</span> <span class="n">input_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span> <span class="o">=</span> <span class="n">repeat_samples</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span> <span class="o">=</span> <span class="n">shuffle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strides</span> <span class="o">=</span> <span class="n">strides</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prediction_length</span> <span class="o">=</span> <span class="n">prediction_length</span> <span class="k">if</span> <span class="n">prediction_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_channels</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">input_channels</span><span class="p">)</span> <span class="k">if</span> <span class="n">input_channels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prediction_channels</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">prediction_channels</span><span class="p">)</span> <span class="k">if</span> <span class="n">prediction_channels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">condition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># same condition for encoder and decoder</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;encoder&#39;</span><span class="p">:</span> <span class="n">condition</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;encoder&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">condition</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Require at least `encoder` item in `condition`.&#39;</span><span class="p">)</span>

        <span class="c1"># prepare condition</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">condition</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">condition</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_prepare_condition</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_condition</span><span class="p">(</span><span class="n">value</span><span class="p">)})</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span>

    <span class="k">if</span> <span class="n">ensemble_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ensemble_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ensemble_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ensemble_size</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">repeat_samples</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">ensemble_range</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ensemble_replace</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">repeat_samples</span><span class="si">=}</span><span class="s1"> must not be larger than </span><span class="si">{</span><span class="n">ensemble_range</span><span class="si">=}</span><span class="s1">&#39;</span> \
                <span class="sa">f</span><span class="s1">&#39; if sampling without replacement (</span><span class="si">{</span><span class="n">ensemble_replace</span><span class="si">=}</span><span class="s1">)&#39;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="n">val_ensemble_type</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="s1">&#39;random_full&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">ensemble_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val_ensemble_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ensemble_type</span><span class="si">=}</span><span class="s1"> must be in </span><span class="si">{</span><span class="n">val_ensemble_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ensemble_index</span><span class="p">)</span> <span class="k">if</span> <span class="n">ensemble_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_type</span> <span class="o">=</span> <span class="n">ensemble_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_range</span> <span class="o">=</span> <span class="n">ensemble_range</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_embedding</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shuffle_data</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">tp_period</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;time must be given if tp_period is given&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tp_harmonics</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tp_harmonics</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tp_period</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Length of `time` must match length of `datasets`&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tp_harmonics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tp_harmonics</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">tp_period</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tp_harmonics</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">sph_degree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">set_size</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sph_harmonics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sph_harmonics</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">sph_degree</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sph_harmonics</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">sample_weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_weights</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`sample_weights` must have the same length as `datasets`&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sample_weights</span> <span class="o">=</span> <span class="n">sample_weights</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="VAE.generators.FitGenerator.nr_samples" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">VAE.generators.FitGenerator.nr_samples</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">nr_samples</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return number of samples.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h4 id="VAE.generators.FitGenerator.__getitem__" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.FitGenerator.__getitem__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__getitem__</span><span class="p">(</span><span class="nf">idx</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return batch of data.</p>
<p>Note that the effective batch size is <code>batch_size * repeat_samples</code>.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>idx</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>Batch index.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code>tuple[dict, dict]</code>
        –
        <div class="doc-md-description">
          <p>Two dicts, one for the inputs and one for the targets.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return batch of data.</span>

<span class="sd">    Note that the effective batch size is `batch_size * repeat_samples`.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        idx:</span>
<span class="sd">            Batch index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Two dicts, one for the inputs and one for the targets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__len__</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;batch index out of range&#39;</span><span class="p">)</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">batch_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">:(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_channels</span><span class="p">]</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>
    <span class="n">batch_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_samples</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>
    <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;encoder_input&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch_x</span>
    <span class="n">targets</span><span class="p">[</span><span class="s1">&#39;decoder&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch_x</span>

    <span class="n">encoder_cond</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">decoder_cond</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sph_harmonics</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sph_cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sph_harmonics</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
        <span class="n">sph_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">sph_cond</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">encoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sph_cond</span><span class="p">)</span>
        <span class="n">decoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sph_cond</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tp_harmonics</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tp_cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_condition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tp_harmonics</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
        <span class="n">encoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tp_cond</span><span class="p">)</span>
        <span class="n">decoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tp_cond</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ex_cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_condition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">[</span><span class="s1">&#39;encoder&#39;</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;decoder&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dx_cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_condition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">[</span><span class="s1">&#39;decoder&#39;</span><span class="p">],</span> <span class="n">idx</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dx_cond</span> <span class="o">=</span> <span class="n">ex_cond</span>
        <span class="n">encoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ex_cond</span><span class="p">)</span>
        <span class="n">decoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dx_cond</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_sync</span><span class="p">:</span>
            <span class="n">ens_cond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ensemble_condition</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
            <span class="n">encoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ens_cond</span><span class="p">)</span>
            <span class="n">decoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ens_cond</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">encoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ensemble_condition</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>
            <span class="n">decoder_cond</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_ensemble_condition</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">encoder_cond</span><span class="p">:</span>
        <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;encoder_cond&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">encoder_cond</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;decoder_cond&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">decoder_cond</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">batch_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">:(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction_channels</span><span class="p">]</span>
        <span class="n">batch_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_samples</span><span class="p">(</span><span class="n">batch_y</span><span class="p">)</span>
        <span class="n">targets</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">batch_y</span>
        <span class="k">if</span> <span class="s1">&#39;decoder_cond&#39;</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
            <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;prediction_cond&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;decoder_cond&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_scheduler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_scheduler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epoch</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">idx</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">sw</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
        <span class="n">sw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">samples_weights</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;decoder&#39;</span><span class="p">:</span> <span class="n">sw</span><span class="p">,</span> <span class="s1">&#39;prediction&#39;</span><span class="p">:</span> <span class="n">sw</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">samples_weights</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="VAE.generators.FitGenerator.get_ensemble_condition" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.FitGenerator.get_ensemble_condition</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_ensemble_condition</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return ensemble condition for given batch.</p>
<p>A one-hot encoded ensemble index is return that is the same for all samples in the batch. The code is
broadcasted along the second dimension of size <code>set_size</code>.</p>
<p>In case of <code>repeat_samples &gt; 1</code>, the actual batch size is <code>batch_size * repeat_samples</code> and a set of
<code>repeat_samples</code>random indices is sampled.</p>
<p>To alter between sampling with and without replacement, the <code>ensemble_replace</code> flag can be set.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>batch_size</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>Batch size.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>idx</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Required if <code>ensemble_type='index</code>. Returns the ensemble condition corresponding to the batch with index
<code>idx</code>.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size * repeat_samples, set_size, ensemble_size)</code></p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_ensemble_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ensemble condition for given batch.</span>

<span class="sd">    A one-hot encoded ensemble index is return that is the same for all samples in the batch. The code is</span>
<span class="sd">    broadcasted along the second dimension of size `set_size`.</span>

<span class="sd">    In case of `repeat_samples &gt; 1`, the actual batch size is `batch_size * repeat_samples` and a set of</span>
<span class="sd">    `repeat_samples`random indices is sampled.</span>

<span class="sd">    To alter between sampling with and without replacement, the `ensemble_replace` flag can be set.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        batch_size:</span>
<span class="sd">            Batch size.</span>
<span class="sd">        idx:</span>
<span class="sd">            Required if `ensemble_type=&#39;index`. Returns the ensemble condition corresponding to the batch with index</span>
<span class="sd">            `idx`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of shape `(batch_size * repeat_samples, set_size, ensemble_size)`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_type</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
        <span class="n">ensemble_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_range</span><span class="p">),</span>
                                        <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="p">,</span>
                                        <span class="n">replace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_replace</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">condition</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="p">),</span> <span class="p">:,</span> <span class="n">ensemble_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_type</span> <span class="o">==</span> <span class="s1">&#39;random_full&#39;</span><span class="p">:</span>
        <span class="n">ensemble_idx</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_range</span><span class="p">),</span>
                             <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="p">,</span>
                             <span class="n">replace</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_replace</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">ensemble_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">ensemble_idx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_size</span><span class="p">),</span>
                             <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">condition</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="p">),</span> <span class="p">:,</span> <span class="n">ensemble_idx</span><span class="o">.</span><span class="n">flat</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># `index`</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__len__</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;batch index out of range&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;idx must be given&#39;</span><span class="p">)</span>

        <span class="n">ensemble_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_index</span><span class="p">(</span><span class="n">idx</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ensemble_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_index</span><span class="p">[</span><span class="n">ensemble_idx</span><span class="p">]</span>

        <span class="n">condition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ensemble_idx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_size</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">condition</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ensemble_idx</span><span class="p">)),</span> <span class="p">:,</span> <span class="n">ensemble_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">condition</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="VAE.generators.FitGenerator.get_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.FitGenerator.get_index</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_index</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return array of dataset and time index of samples in batch.</p>
<p>The returned array is of shape <code>(batch_size * repeat_samples, 2)</code> with the first column containing the dataset
index and the second column the time index of the sample. The time index refers to the first sample of the
target sequence for the prediction.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>idx</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>Batch index.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(batch_size * repeat_samples, 2)</code>.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return array of dataset and time index of samples in batch.</span>

<span class="sd">    The returned array is of shape `(batch_size * repeat_samples, 2)` with the first column containing the dataset</span>
<span class="sd">    index and the second column the time index of the sample. The time index refers to the first sample of the</span>
<span class="sd">    target sequence for the prediction.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        idx:</span>
<span class="sd">            Batch index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of shape `(batch_size * repeat_samples, 2)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__len__</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s1">&#39;batch index out of range&#39;</span><span class="p">)</span>

    <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">idx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">:(</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_repeat_samples</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">indices</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="VAE.generators.FitGenerator.get_sph_harmonics" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.FitGenerator.get_sph_harmonics</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_sph_harmonics</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">sph_degree</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get spherical harmonics.</p>
<p>The returned array is of shape <code>(set_size, 2 * sph_degree + 1)</code> with the rows containing the spherical harmonics
for the given latitude and longitude values.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>latitude</code></b>
        –
        <div class="doc-md-description">
          <p>float
Latitude value in degree.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>longitude</code></b>
        –
        <div class="doc-md-description">
          <p>array_like
Array of longitude values in degree of shape <code>(set_size,)</code>.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(set_size, 2 * sph_degree + 1)</code>.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_sph_harmonics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">longitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sph_degree</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get spherical harmonics.</span>

<span class="sd">    The returned array is of shape `(set_size, 2 * sph_degree + 1)` with the rows containing the spherical harmonics</span>
<span class="sd">    for the given latitude and longitude values.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        latitude : float</span>
<span class="sd">            Latitude value in degree.</span>
<span class="sd">        longitude : array_like</span>
<span class="sd">            Array of longitude values in degree of shape `(set_size,)`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of shape `(set_size, 2 * sph_degree + 1)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">latitude</span><span class="p">)</span>  <span class="c1"># [0, pi]</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">longitude</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  <span class="c1"># [0, 2*pi]</span>

    <span class="n">sph</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sph_degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">sph_harm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">colat</span><span class="p">)</span>
        <span class="n">sph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">sph_harm</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">colat</span><span class="p">)</span>
            <span class="n">sph</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">sph</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="VAE.generators.FitGenerator.get_tp_harmonics" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.FitGenerator.get_tp_harmonics</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_tp_harmonics</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">tp_period</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get temporal harmonics.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>time</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>)
        –
        <div class="doc-md-description">
          <p>Array of time values for which the harmonics are calculated.</p>
        </div>
      </li>
      <li class="doc-section-item field-body">
        <b><code>tp_period</code></b>
            (<code>int</code>)
        –
        <div class="doc-md-description">
          <p>Maximal period for the temporal harmonics in time units.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        –
        <div class="doc-md-description">
          <p>Array of shape <code>(len(times), tp_period)</code>.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_tp_harmonics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">tp_period</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get temporal harmonics.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        time:</span>
<span class="sd">            Array of time values for which the harmonics are calculated.</span>
<span class="sd">        tp_period:</span>
<span class="sd">            Maximal period for the temporal harmonics in time units.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Array of shape `(len(times), tp_period)`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">tp_period</span><span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>  <span class="c1"># omit DC</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="n">harmonics</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">time</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">time</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">harmonics</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="VAE.generators.FitGenerator.on_epoch_end" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.FitGenerator.on_epoch_end</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">on_epoch_end</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Shuffle data after each epoch.</p>
<p>This method is called after each epoch and shuffles the data if <code>shuffle=True</code>.</p>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">on_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Shuffle data after each epoch.</span>

<span class="sd">    This method is called after each epoch and shuffles the data if `shuffle=True`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shuffle_data</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="VAE.generators.FitGenerator.summary" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.FitGenerator.summary</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">summary</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Print summary.</p>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print summary.&quot;&quot;&quot;</span>
    <span class="n">total_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">dataset</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">])</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of datasets : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datasets</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total data size    : </span><span class="si">{</span><span class="n">total_size</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total data length  : </span><span class="si">{</span><span class="n">total_length</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Strides            : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">strides</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of samples  : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nr_samples</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Batch size         : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of batches  : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">act_batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sample repetitions : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Actual batch size  : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> * </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span><span class="si">}</span><span class="s1"> = </span><span class="si">{</span><span class="n">act_batch_size</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shuffle            : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_length</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">ny</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Filter length&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  input      : </span><span class="si">{</span><span class="n">nx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  prediction : </span><span class="si">{</span><span class="n">ny</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ensemble condition&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  size : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_size</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  type : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="s1">&#39;random_full&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  range   : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_range</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  sync    : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_sync</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  replace : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ensemble_replace</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">channels</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">))[</span><span class="bp">self</span><span class="o">.</span><span class="n">input_channels</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Input channels     : all&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Input channels     : </span><span class="si">{</span><span class="n">channels</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction_length</span><span class="p">:</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">))[</span><span class="bp">self</span><span class="o">.</span><span class="n">prediction_channels</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Predicted channels : all&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predicted channels : </span><span class="si">{</span><span class="n">channels</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># get samples</span>
    <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># unpack items</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">,</span> <span class="n">sample_weights</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Output shapes&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  inputs&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">inputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">key</span><span class="si">:</span><span class="s1">&lt;16.16</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">targets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  targets&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">key</span><span class="si">:</span><span class="s1">&lt;16.16</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sample_weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  sample_weights&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sample_weights</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;    </span><span class="si">{</span><span class="n">key</span><span class="si">:</span><span class="s1">&lt;16.16</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h3 id="VAE.generators.PredictGenerator" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">VAE.generators.PredictGenerator</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">PredictGenerator</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">input_length</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">beta_scheduler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensemble_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensemble_type</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">ensemble_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensemble_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ensemble_replace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ensemble_sync</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filter_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_epoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prediction_channels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prediction_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">repeat_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sample_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sph_degree</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tp_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="VAE.generators.FitGenerator" href="#VAE.generators.FitGenerator">FitGenerator</a></code></p>

  
      <p>Generator class for model prediction.</p>
<p>The generator prepares the inputs for the model prediction with :func:<code>ks.Model.predict</code>.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        <b><code>**kwargs</code></b>
        –
        <div class="doc-md-description">
          <p>See :class:<code>FitGenerator</code> for parameters.</p>
        </div>
      </li>
  </ul>



  <p><span class="doc-section-title">Returns:</span></p>
  <ul>
      <li class="doc-section-item field-body">
        –
        <div class="doc-md-description">
          <p>Dictionary containing the inputs for the model prediction.</p>
      </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>VAE/generators.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">datasets</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]],</span>
             <span class="n">input_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
             <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
             <span class="n">beta_scheduler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">condition</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">ensemble_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">ensemble_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;random&#39;</span><span class="p">,</span>
             <span class="n">ensemble_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">ensemble_range</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">ensemble_replace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">ensemble_sync</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">filter_length</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">initial_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">input_channels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">latitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">longitude</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">prediction_channels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">prediction_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">repeat_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">sample_weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">shuffle</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">sph_degree</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">strides</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
             <span class="n">time</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">tp_period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;float32&#39;</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate generator.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">datasets</span><span class="p">]</span>

    <span class="n">shapes</span> <span class="o">=</span> <span class="p">{</span><span class="n">dataset</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;all datasets must have the same set_size and number of channels&#39;</span><span class="p">)</span>

    <span class="n">set_size</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="n">channels</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_size</span> <span class="o">=</span> <span class="n">set_size</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">beta_scheduler</span> <span class="o">=</span> <span class="n">beta_scheduler</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">datasets</span> <span class="o">=</span> <span class="n">datasets</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_replace</span> <span class="o">=</span> <span class="n">ensemble_replace</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_size</span> <span class="o">=</span> <span class="n">ensemble_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_sync</span> <span class="o">=</span> <span class="n">ensemble_sync</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span> <span class="o">=</span> <span class="n">initial_epoch</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filter_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">filter_length</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">input_length</span> <span class="o">=</span> <span class="n">input_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">repeat_samples</span> <span class="o">=</span> <span class="n">repeat_samples</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span> <span class="o">=</span> <span class="n">shuffle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">strides</span> <span class="o">=</span> <span class="n">strides</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prediction_length</span> <span class="o">=</span> <span class="n">prediction_length</span> <span class="k">if</span> <span class="n">prediction_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">input_channels</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">input_channels</span><span class="p">)</span> <span class="k">if</span> <span class="n">input_channels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prediction_channels</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">prediction_channels</span><span class="p">)</span> <span class="k">if</span> <span class="n">prediction_channels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">condition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># same condition for encoder and decoder</span>
            <span class="n">condition</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;encoder&#39;</span><span class="p">:</span> <span class="n">condition</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;encoder&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">condition</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Require at least `encoder` item in `condition`.&#39;</span><span class="p">)</span>

        <span class="c1"># prepare condition</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">condition</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="n">condition</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_prepare_condition</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">condition</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_condition</span><span class="p">(</span><span class="n">value</span><span class="p">)})</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span>

    <span class="k">if</span> <span class="n">ensemble_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ensemble_range</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ensemble_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ensemble_size</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">repeat_samples</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">ensemble_range</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ensemble_replace</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">repeat_samples</span><span class="si">=}</span><span class="s1"> must not be larger than </span><span class="si">{</span><span class="n">ensemble_range</span><span class="si">=}</span><span class="s1">&#39;</span> \
                <span class="sa">f</span><span class="s1">&#39; if sampling without replacement (</span><span class="si">{</span><span class="n">ensemble_replace</span><span class="si">=}</span><span class="s1">)&#39;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="n">val_ensemble_type</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="s1">&#39;random_full&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">ensemble_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val_ensemble_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ensemble_type</span><span class="si">=}</span><span class="s1"> must be in </span><span class="si">{</span><span class="n">val_ensemble_type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ensemble_index</span><span class="p">)</span> <span class="k">if</span> <span class="n">ensemble_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_type</span> <span class="o">=</span> <span class="n">ensemble_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ensemble_range</span> <span class="o">=</span> <span class="n">ensemble_range</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_embedding</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shuffle_data</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">tp_period</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;time must be given if tp_period is given&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tp_harmonics</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tp_harmonics</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tp_period</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Length of `time` must match length of `datasets`&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tp_harmonics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tp_harmonics</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">tp_period</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tp_harmonics</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">sph_degree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">longitude</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">set_size</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sph_harmonics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sph_harmonics</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">sph_degree</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sph_harmonics</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">sample_weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_weights</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`sample_weights` must have the same length as `datasets`&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sample_weights</span> <span class="o">=</span> <span class="n">sample_weights</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="VAE.generators.PredictGenerator.__getitem__" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.PredictGenerator.__getitem__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__getitem__</span><span class="p">(</span><span class="nf">idx</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return inputs to the model for given batch.</p>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return inputs to the model for given batch.&quot;&quot;&quot;</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">inputs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h3 id="VAE.generators.example_FitGenerator" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">VAE.generators.example_FitGenerator</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">example_FitGenerator</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Example of :class:<code>FitGenerator</code>.</p>
<p>This example shows how to use the :class:<code>FitGenerator</code> class.</p>

          <details class="quote">
            <summary>Source code in <code>VAE/generators.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">example_FitGenerator</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Example of :class:`FitGenerator`.</span>

<span class="sd">    This example shows how to use the :class:`FitGenerator` class.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># first we create some dummy data</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># (set_size, data_length, channels)</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">shape</span><span class="p">)),</span> <span class="n">shape</span><span class="p">)</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>

    <span class="c1"># the corresponding time values</span>
    <span class="n">time</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># and the corresponding conditions</span>
    <span class="c1"># the encoder and decoder conditions are different</span>
    <span class="n">encoder_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">decoder_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

    <span class="c1"># then we create the generator</span>
    <span class="n">fit_gen</span> <span class="o">=</span> <span class="n">FitGenerator</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span>
                           <span class="n">condition</span><span class="o">=</span><span class="p">{</span>
                               <span class="s1">&#39;encoder&#39;</span><span class="p">:</span> <span class="n">encoder_cond</span><span class="p">,</span>
                               <span class="s1">&#39;decoder&#39;</span><span class="p">:</span> <span class="n">decoder_cond</span>
                           <span class="p">},</span>
                           <span class="n">input_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">prediction_length</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                           <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
                           <span class="n">ensemble_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">),</span>
                           <span class="n">ensemble_type</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
                           <span class="n">tp_period</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                           <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
                           <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># we can see the summary of the generator</span>
    <span class="n">fit_gen</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>

    <span class="c1"># we can now use the generator to get the inputs for the model</span>
    <span class="n">inputs</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">fit_gen</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># we can plot the inputs, to see what the model will get</span>
    <span class="c1"># we show the encoder and decoder conditions</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">lax</span><span class="p">,</span> <span class="n">rax</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">lax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;encoder_cond&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">lax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;inputs[&#39;encoder_cond&#39;]&quot;</span><span class="p">)</span>
    <span class="n">mp</span> <span class="o">=</span> <span class="n">rax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;decoder_cond&#39;</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">rax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;inputs[&#39;decoder_cond&#39;]&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="p">(</span><span class="n">lax</span><span class="p">,</span> <span class="n">rax</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Andreas Groth
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/andr-groth" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.sections", "navigation.expand", "content.code.copy", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a7c05c9e.min.js"></script>
      
    
  </body>
</html>